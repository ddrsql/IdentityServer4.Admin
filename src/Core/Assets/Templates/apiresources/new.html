<div id="page-title">
    <h1 class="page-header text-overflow">
        Create New Api Resource
    </h1>
</div>

<div class="panel">
    <div class="panel-body">
        <id-adm-message message="feedback"></id-adm-message>
        <form class="form" ng-submit="create(properties)" name="form" ng-show="create">
            <div ng-repeat="property in properties" class="row" ng-form="childForm">
                <div ng-switch on="property.meta.dataType">
                    <div ng-switch-when="5" class="form-group col-sm-6">
                        <label for="{{property.meta.type}}">
                            {{property.meta.name}}
                            <input type="checkbox" id="{{property.meta.type}}" ng-model="property.data">
                        </label>
                    </div>
                    <span ng-switch-when="1">
                        <div class="form-group">
                            <div class="row">
                                <label class="col-sm-2 control-label" for="{{property.meta.type}}">{{property.meta.name}}</label>
                                <div class="col-sm-5">
                                    <input type="password"
                                           class="form-control"
                                           id="{{property.meta.type}}"
                                           name="data"
                                           placeholder="{{property.meta.name}}"
                                           required
                                           ng-model="property.data">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <label class="col-sm-2 control-label" for="{{property.meta.type}}">Confirm {{property.meta.name}}</label>
                                <div class="col-sm-5">
                                    <input type="password"
                                           class="form-control"
                                           id="confirm_{{property.meta.type}}"
                                           name="confirm"
                                           placeholder="Confirm {{property.meta.name}}"
                                           required
                                           ng-model="confirm"
                                           tt-match="property.data">

                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-sm-5">
                                    <small class="help-block" ng-show="form.data.$dirty && form.data.$error.required">{{property.meta.name}} is required</small>
                                    <small class="help-block" ng-show="form.confirm.$dirty && form.data.$valid && form.confirm.$error.required">Confirm is required</small>
                                    <small class="help-block" ng-show="form.confirm.$dirty && form.data.$valid && form.confirm.$error.ttMatch">Confirm must match</small>
                                </div>
                            </div>
                        </div>
                    </span>
                    <span ng-switch-when="4">
                        <div class="form-group">
                            <div class="row">
                                <label class="col-sm-2 control-label" for="{{property.meta.type}}">{{property.meta.name}}</label>
                                <div class="col-sm-5">
                                    <input type="number"
                                           class="form-control"
                                           id="{{property.meta.type}}"
                                           name="data"
                                           placeholder="{{property.meta.name}}"
                                           ng-model="property.data"
                                           ng-required="property.meta.required">
                                </div>
                                <div class="col-sm-5">
                                    <small class="help-block" ng-show="form.data.$dirty && form.data.$error.required">{{property.meta.name}} is required</small>
                                    <small class="help-block" ng-show="form.data.$dirty && !form.data.$error.required && form.data.$error.number">{{property.meta.name}} must be a number</small>
                                </div>
                            </div>
                        </div>
                    </span>
                    <span ng-switch-when="2">
                        <div class="form-group">
                            <div class="row">
                                <label class="col-sm-2 control-label" for="{{property.meta.type}}">{{property.meta.name}}</label>
                                <div class="col-sm-5">
                                    <input type="email"
                                           class="form-control"
                                           id="{{property.meta.type}}"
                                           name="data"
                                           placeholder="{{property.meta.name}}"
                                           ng-model="property.data"
                                           ng-required="property.meta.required">
                                </div>
                                <div class="col-sm-5">
                                    <small class="help-block" ng-show="form.data.$dirty && form.data.$error.required">{{property.meta.name}} is required</small>
                                    <small class="help-block" ng-show="form.data.$dirty && !form.data.$error.required && form.data.$error.email">{{property.meta.name}} must be a valid email</small>
                                </div>
                            </div>
                        </div>
                    </span>
                    <span ng-switch-when="3">
                        <div class="form-group">
                            <div class="row">
                                <label class="col-sm-2 control-label" for="{{property.meta.type}}">{{property.meta.name}}</label>
                                <div class="col-sm-5">
                                    <input type="url"
                                           class="form-control"
                                           id="{{property.meta.type}}"
                                           name="data"
                                           placeholder="{{property.meta.name}}"
                                           ng-model="property.data"
                                           ng-required="property.meta.required">
                                </div>
                                <div class="col-sm-5">
                                    <small class="help-block" ng-show="form.data.$dirty && form.data.$error.required">{{property.meta.name}} is required</small>
                                    <small class="help-block" ng-show="form.data.$dirty && !form.data.$error.required && form.data.$error.url">{{property.meta.name}} must be a valid URL</small>
                                </div>
                            </div>
                        </div>
                    </span>
                    <span ng-switch-default>
                        <div class="form-group">
                            <div class="row">
                                <label class="col-sm-2 control-label" for="{{property.meta.type}}">{{property.meta.name}}</label>
                                <div class="col-sm-5">
                                    <input type="text"
                                           class="form-control"
                                           id="{{property.meta.type}}"
                                           name="data"
                                           placeholder="{{property.meta.name}}"
                                           ng-model="property.data"
                                           ng-required="property.meta.required">
                                </div>
                                <div class="col-sm-5">
                                    <small class="help-block" ng-show="form.data.$dirty && form.data.$error.required">{{property.meta.name}} is required</small>
                                </div>
                            </div>
                        </div>
                    </span>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <button class="btn btn-primary" ng-disabled="form.$invalid">Create</button>
                    <a ng-show="last"
                       class="btn btn-default"
                       href="#/apiresources/edit/{{last.data.subject}}">Edit Api Resource: {{last.data.subject}}</a>
                </div>
            </div>
        </form>
    </div>
</div>